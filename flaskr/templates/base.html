<!DOCTYPE html>
<html>
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
       
        <!-- Bootstrap CSS and JS-->
        <title>Social Network Analysis and Simulation</title>
        <link rel="stylesheet" href="/static/libs/bootstrap/css/bootstrap.min.css">
        <link href="/static/libs/fontawesome/css/all.min.css" rel="stylesheet">
        
        <link href="/static/libs/chartist/chartist.min.css" rel="stylesheet">
        
        
        <meta charset="utf-8">
        <title></title>
        <style>
          #sidebar, #results{
            /*height: calc(100%-56px);*/
            /*align-self: stretch;*/
          }

          #main {
            height: 100vh;
          }

          #netgraph {
            width: 100%;
            height: 100%;
          }

          #netgraph > svg {
            width: 100%;
            height: 100%;
          }

          .node-normal {
            fill: #84BD00;
            stroke: #2c282c;
            stroke-width: 1.5px;
          }

          .node-seed {
            fill: #f55;
            stroke: #2c282c;
            stroke-width: 1.5px;
          }

          .opinion {
            stroke: turquoise;
            stroke-width: 3px;
          }

          .link-normal {
            stroke: #848587;
            stroke-width: 1px;
            stroke-opacity: .75;
          }

          .hide{
            display:none;
          }
          
          [name="model"] {
            -webkit-appearance: checkbox; /* Chrome, Safari, Opera */
            -moz-appearance: checkbox;    /* Firefox */
            -ms-appearance: checkbox;     /* not currently supported */
          }
        .graphbox{
          width:100% ;
          height: 400px;
        }

        .box{
          display:flex;
          flex-direction:column;
          align-items:stretch;
          width: 100vw;
          height: 100vh;
        }

        .box1{

        }
        .box2{
          display:flex;
          align-items:stretch;
          height: 100%;
        }
        
        .box21 {
          width: 35vw;
        }
        .box22 {
          width: 65vw;
        }

        /*#matter1 {
          display: grid;
          grid-template-columns: 2fr 3fr;
          grid-gap: 5px 5px;
          align-items: center;
          justify-content: center;
        }*/
        
        </style>

    </head>
<body>

<div class="box">
  <div class="box1">
    <nav class="navbar navbar-expand-sm navbar-light bg-light">
                <a class="navbar-brand" href="#">AAAAA</a>
                  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                  </button>
                      <div class="collapse navbar-collapse" id="navbarNavDropdown">
                        <ul class="navbar-nav">
                          <li class="nav-item active">
                            <a class="nav-link" href="#">File <span class="sr-only">(current)</span></a>
                          </li>
                          <li class="nav-item">
                            <a class="nav-link" href="#">Analysis</a>
                          </li>
                          <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              Network
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                              <a class="dropdown-item" href="#" id="SWG">Small World</a>
                              <a class="dropdown-item" href="#" id="Pre">PreAttach</a>
                              <a class="dropdown-item" href="#" id="rnd">Random</a>                                               
                            </div>
                          </li>
                          <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              Community
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                              <a class="dropdown-item" href="#">CNM</a>
                            </div>
                          </li>
                          <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                              Simulator
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                              <a class="dropdown-item" href="#" id="">City Level</a>
                              <a class="dropdown-item" href="#" id="userlevel">User Level</a>
                            </div>
                  </li>
                </ul>
              </div>
            </nav>
    </div>  
   
      <div class="box2"> 
        <div class="box21">
                  <div id="matter1" class="hide">  
                    <h5 class="modal-title" id="exampleModalLabel">Small World Graph Generator</h5>                       
                    <div class="container">
                    <div class="row">
                        <div ><label for="nodes">Nodes</label></div>
                        <div ><input type="number" id="nodes" name="nodes" min="1"></div>
                        <div class="w-100"></div>
                        <div ><label for="edges">Out Degree</label></div>
                        <div ><input type="number" id="outdegree" name="edges" min="0"></div>
                        <div class="w-100"></div>
                        <div ><label for="rewirepb">Rewire Probability</label></div>
                        <div ><input type="number" id="rewirepb" name="infected" min="0" max="1" step="1e-5" vaule="0.1"></div>
                        <div class="w-100"></div>
                        </div>
                        </div>
                        <button type="button" class="btn btn-primary"id="SWGrun">Run</button>
   
                  </div>

                  <div id="matter2" class="hide">     
                  <h5 class="modal-title" id="exampleModalLabel">PreAttach Graph Generator</h5>
                    <div class="container">
                      <div class="row">
                        <div ><label for="nodes">Nodes</label></div>
                        <div ><input type="number" id="Pre_nodes" name="nodes" min="1"></div>
                        <div class="w-100"></div>
                        <div ><label for="edges">Out Degree</label></div>
                        <div ><input type="number" id="Pre_outdegree" name="edges" min="0"></div>
                        <div class="w-100"></div>
                      </div>
                    </div>
                      <button type="button" class="btn btn-primary" id="Prefrun">Run</button>
                  </div>
                           

                  <div id="matter3" class="hide">         
                  <h5 class="modal-title" id="exampleModalLabel">Random Graph Generator</h5>
                    <div class="container">
                      <div class="row">
                        <div ><label for="nodes">Nodes</label></div>
                        <div ><input type="number" id="random_nodes" name="nodes" min="1"></div>
                        <div class="w-100"></div>
                        <div ><label for="edges">Edges</label></div>
                        <div ><input type="number" id="random_edges" name="edges" min="0"></div>
                        <div class="w-100"></div>
                      </div>
                    </div>
                        <button type="button" class="btn btn-primary" id="randomrun">Run</button>
                  </div>
                  

                  <div id="matter4" class="hide">         
                    <h5 class="modal-title" id="exampleModalLabel">Seeds Nodes</h5>
                      <div class="container">
                        <div class="row">
                          <div class="col"><label for="seeds_nodes">Seeds Nodes</label></div>
                          <div class="col"><input type="number" id="seeds_nodes" name="nodes" min="1"></div>
                          <div class="w-100"></div>
                          <div class="col"><label for="algorithm" >Algorithm</label></div>
                          <div class="col">
                          <select id="seeds_algorithm">
                          <option value="Degree Centrality">Degree Centrality</option>
                          <option value="Between">Between Centrality</option>
                          <option value="Closeness">Closeness Centrality</option>
                          <option value="Eigenvect">Eigenvect Centrality</option>
                          <option value="Random">Random Centrality</option>
                          </select>
                          </div>
                    </div></div>
                <div class="container">
                  <div class="row">
                    <div class="col">
                      <button type="button" class="btn btn-primary" id="seedsgraph">Generator Seeds Nodes</button>
                    </div>
                    <div class="w-100"></div>

                    <h5 class="modal-title" >Opinoion Leaders</h5>
                    <div class="w-100"></div>
                    <div class="col">
                      <input type="radio" name="opinion" value="whole_network" id="whole" checked> Whole Network <br>
                      <div class="w-100"></div>
                      <input type="radio" name="opinion" value="eachcommunity" id="each"> Each Community<br>
                      </div>
                        <div class="w-100"></div>
                        <div class="col"><label for="proportion">Propotion</label></div>
                        <div class="col"><input type="number" id="proportion" name="nodes" min="0" max="1" step="1e-5"></div>
                        </div></div>
                        <div class="container" id="models">
                        <div class="row">
                        <div class="col">
                        <button type="button" class="btn btn-primary" id="Genopin">Generator Opinion Leaders</button>
                        </div>

                <div class="w-100"></div>
                <div class="col"><input type="radio" name="model" class="model1" value="LTM" checked> Linear Threshold Model</div>
                <div class="w-100"></div>
                <div class="col"><label for="icmopin">Threshold </label></div>
                <div class="col"><input type="number" id="ltmthre" class="model1" name="opinpro" min="0" max="1" step="1e-5"></div>
                <div class="w-100"></div>
                <div class="col"><input type="radio" name="model" class="model2" value="ICM"> Independent Cascade Model</div>
                <div class="w-100"></div>
                <div class="col"><label for="icmopin">Propagate Probability(Opinion Leader) </label></div>
                <div class="col"><input type="number" id="probabilityopinleader" class="model2" name="opinpro" min="0" max="1" step="1e-5" disabled></div>
                <div class="w-100"></div>
                <div class="col"><label for="icmnor">Propagate Probability(Noraml) </label></div>
                <div class="col"><input type="number" id="probabilitynormal" class="model2"name="pronor" min="0" max="1" step="1e-5" disabled></div>
                <div class="w-100"></div>
                <div class="col">
                <button type="button" class="btn btn-primary" id="infordif">Information Difussion</button>
                </div>
                </div>
                </div>
                </div>

                  </div>
          <div class="box22">
                  <div id="netgraph" ></div>
            </div> 
          </div> 
      </div>
  
  
      <script src="/static/libs/jquery-3.3.1.min.js" ></script>
      <script src="/static/libs/popper.min.js"></script>
      <script src="/static/libs/bootstrap/js/bootstrap.min.js"></script>
      <script src="/static/libs/chartist/chartist.min.js"></script>
      <script src="/static/libs/d3.min.js"></script>

      <script>

          function reveal(functionID){
           var mapping = {
              "SWG" : "matter1",
              "Pre" : "matter2",
              "rnd" : "matter3",
              "userlevel" : "matter4"
            }
          
          var targetID = mapping[functionID]
          console.log($(".box21").children())
          $(".box21").children().not('[class~="hide"]').addClass("hide")
          if ($("#"+targetID).hasClass("hide")){
            $("#"+targetID).removeClass("hide")
          }
          }

          let forceGraph = (options) => {
              let anchor = options['anchor']
              let nodeRadius = options['nodeRadius']

              let svg = d3.select(anchor).append('svg')
              let shapes = svg.append('g')
              let zoom = (zoomView, minExtent, maxExtent) => d3.zoom().scaleExtent([minExtent, maxExtent]).on('zoom', () => zoomView.attr('transform', d3.event.transform))
              svg.call(zoom(shapes, .25, 8))

              let w = svg.node().parentNode.clientWidth
              let h = svg.node().parentNode.clientHeight

              let simulation = d3.forceSimulation()
                .force('charge', d3.forceManyBody())
                .force('center', d3.forceCenter(w / 2, h / 2))
                .force('collide', d3.forceCollide(1))
              let draggable = d3.drag()
                .on('start', datum => {
                  if (!d3.event.active) simulation.alphaTarget(.3).restart()
                  datum.fx = datum.x
                  datum.fy = datum.y
                })
                .on('drag', datum => {
                  datum.fx = d3.event.x
                  datum.fy = d3.event.y
                })
                .on('end', datum => {
                  if (!d3.event.active) simulation.alphaTarget(0)
                  datum.fx = null
                  datum.fy = null
                })

              let bindLinks = (dataset, anchor) => {
                let slots = anchor.selectAll('line').data(dataset)
                slots.exit().remove()
                let gLinks = slots.enter().append('line')
                  .merge(slots).attr('id', datum => 'l' + datum['id'])
                  .classed('link-normal', true)
                return gLinks
              }
              
              let bindNodes = (dataset, anchor) => {
                let slots = anchor.selectAll('g').data(dataset)
                slots.exit().remove()
                let gNodes = slots.enter().append('g')
                gNodes.append('circle').attr('r', nodeRadius).classed('node-normal', d => !d['seed']).classed('node-seed', d => d['seed']).classed('opinion', d => d['opinion_leader'])
                gNodes = gNodes.merge(slots).attr('id', datum => datum.id).call(draggable)
                return gNodes
              }

              let linkAnchor = shapes.append('g').classed('links', true)

              let nodeAnchor = shapes.append('g').classed('nodes', true)

              let importData = (nodeArr, linkArr) => {

                let nodes = bindNodes(nodeArr, nodeAnchor)
                let links = bindLinks(linkArr, linkAnchor)
                
                let ticked = () => {
                  links.attr('x1', (datum) => datum['source'].x)
                  .attr('y1', (datum) => datum['source'].y)
                  .attr('x2', (datum) => datum['target'].x)
                  .attr('y2', (datum) => datum['target'].y)

                  nodes.attr('transform', datum => `translate(${datum.x}, ${datum.y})`)
                }

                simulation.nodes(nodeArr).on('tick', ticked)
                simulation.force('link', d3.forceLink(linkArr).id(datum => datum['id']))
                simulation.alphaTarget(.3).restart()
              }
              return importData
            }

          let fg = forceGraph({
              anchor: '#netgraph',
              nodeRadius: 5
            });

          
          $( "#SWG" ).click(function() {
            console.log('swg');
            reveal("SWG");
          });

          $( "#Pre" ).click(function() {
            console.log('pre');
            reveal("Pre");
          }); 

          $( "#rnd" ).click(function() {
            console.log('rnd');
            reveal("rnd");
          }); 

          $( "#userlevel" ).click(function() {
            console.log('user')
            reveal("userlevel");
          }); 

          $('[name="model"]').click(function() {
            var currentID = $('[name="model"]:checked').attr('class')
            $('#models input[name!="model"][class="' + currentID + '"]').attr('disabled', false)
            $('#models input[name!="model"][class!="' + currentID + '"]').attr('disabled', true)
          })

                                 
          $( "#SWGrun" ).click(function() {
            console.log($('#nodes').val())
            var nodes=parseInt($('#nodes').val());
            console.log(nodes)
            if(nodes<=0) {
              nodes=Math.random()*10; }
            var outdegree=parseInt($('#outdegree').val());
            if(outdegree<0) {
              outdegree=Math.random()*10; }
            var rewirepb=parseFloat($('#rewirepb').val());
            if(rewirepb<0) {
              rewirepb=Math.random(); }
            
            
            $.ajax({
            url: "/smallworld",
            type:'POST',
            data: {"nodes":nodes,"outdegree":outdegree,"rewirepb":rewirepb}
            }).done(function(res) {
            //chartist
            var obj = JSON.parse(res)
            fg(obj['nodes'], obj['links']);
                
            console.log(res)
            })
          });
         

          $( "#PrefA" ).click(function() {
            $('#PreADialog').modal('show');
          }); 

          $( "#Prefrun" ).click(function() {
            var nodes=parseInt($('#Pre_nodes').val());
            console.log(nodes)
            if(nodes<=0) {
              nodes=Math.random()*10; }
            var outdegree=parseInt($('#Pre_outdegree').val());
            if(outdegree<0) {
              outdegree=Math.random()*10; }
          
            $.ajax({
            url: "/PrefAttach",
            type:'POST',
            data: {"nodes":nodes,"outdegree":outdegree}
            }).done(function(res) {
            //chartist
            var obj = JSON.parse(res)
            console.log(obj)
            fg(obj['nodes'], obj['links']);
                
            
            })
          });

          $( "#random" ).click(function() {
            $('#RandomDialog').modal('show');
          }); 

          $( "#randomrun" ).click(function() {
            var nodes=parseInt($('#random_nodes').val());
            console.log(nodes)
            if(nodes<=0) {
              nodes=Math.random()*10; }
            var edges=parseInt($('#random_edges').val());
            if(edges<0) {
              edges=Math.random()*10; }
          
            $.ajax({
            url: "/Random",
            type:'POST',
            data: {"nodes":nodes,"edges":edges}
            }).done(function(res) {
            //chartist
            var obj = JSON.parse(res)
            fg(obj['nodes'], obj['links']);
                
            console.log(res)
            })
          });

          $( "#seedsgraph" ).click(function() {
            var seednodes=parseInt($('#seeds_nodes').val());
            console.log(seednodes)
            if(seednodes<=0) {
              seednodes=Math.random()*10; }
            var algorithm=($('#seeds_algorithm').val());
            
            $.ajax({
            url: "/seednodes",
            type:'PUT',
            cache: false,
            data: {"seednodes":seednodes,"algorithm":algorithm}
            }).done(function(res) {
            //chartist
            var obj = JSON.parse(res)
            $('#netgraph').empty()
            let fg = forceGraph({
              anchor: '#netgraph',
              nodeRadius: 5
            });
            fg(obj['nodes'], obj['links']);   
            console.log(res)
            })
          });

          $("#Genopin" ).click(function() {
            var com=$('[name="opinion"]:checked').val()
            console.log(com)
            var pro_opinion=parseFloat($('#proportion').val()) || 0.0;
            console.log(pro_opinion)

            $.ajax({
            url: "/comm",
            type:'PUT',
            cache: false,
            data: {"pro_opinion":pro_opinion,"search_type":com}
            }).done(function(res) {
            //chartist
            var obj = JSON.parse(res)
            $('#netgraph').empty()
            let fg = forceGraph({
              anchor: '#netgraph',
              nodeRadius: 5
            });
            fg(obj['nodes'], obj['links']);   
            console.log(res)
            })
          });

          $( "#infordif" ).click(function() {
            var seednodes=parseInt($('#seeds_nodes').val());
            console.log(seednodes)
            if(seednodes<=0) {
              seednodes=Math.random()*10; }
            var algorithm=($('#seeds_algorithm').val());
            
            var model_type=$('[name="model"]:checked').val()
            console.log(model_type)
            
            var obj = {'seednodes':seednodes,
                      'algorithm':algorithm,
                      'model_type': model_type}
            if(model_type=="LTM"){
              obj['threshold'] = parseFloat($('#ltmthre').val());}
            else if(model_type=="ICM"){
              obj ['pbopinion'] = parseFloat($('#probabilityopinleader').val())
              obj ['pbnormal'] = parseFloat($('#probabilitynormal').val())
              obj ['opinleader'] = $('[name="opinion"]:checked').val()
              obj ['pbobinleader'] = parseFloat($('#proportion').val()) || 0.0;
            }
            
            $.ajax({
            url: "/diff",
            type:'PUT',
            cache: false,
            data: obj,
            }).done(function(res) {
            //chartist
            var obj = JSON.parse(res)
            $('#netgraph').empty()
            let fg = forceGraph({
              anchor: '#netgraph',
              nodeRadius: 5
            });
            fg(obj['nodes'], obj['links']);   
            console.log(res)
            })
          });
          /*$( "#run" ).click(function() {
            var nodes=parseInt($('#nodes').val());
            if(nodes<=0) {
              nodes=Math.random()*10;
            }
            var edges=parseInt($('#edges').val());
            if(nodes<0) {
              edges=Math.random()*10;
            }
            var infected=parseFloat($('#infected').val());
            if(infected<0 || infected>1){
              infected=Math.random();
            }
            var threshold=parseFloat($('#threshold').val());
            if(threshold<0 || threshold>1){
              threshold=Math.random();
            }
            var iteration=parseInt($('#iteration').val());
            if(iteration<0){
              iteration=Math.abs(iteration);
            }

            $.ajax({
            url: "/smallworld",
            type:'POST',
            data: {"nodes":nodes,"outdegree":outdegree,"infected":infected,"threshold":threshold,"iteration":iteration}
            }).done(function(res) {
            //chartist
            var obj = JSON.parse(res)

            new Chartist.Line('.ct-chart', obj);
                
            console.log(res)
            })
          

            $.ajax({
            url: "/simulator1",
            type:'POST',
            data: {"nodes":nodes,"edges":edges,"rewirepb":rewirepb}
            }).done(function(res) {
            //chartist
            var obj = JSON.parse(res)
            
            
            new Chartist.Line('.ct-chart', obj);
                
            console.log(res)
            })
          });*/


    
        
      </script>
  <!--
    <body>
        <nav class="navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow">
          <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="#">#Project name#</a>
        </nav>
       
        <div class="container-fluid">
          <div class="row">
            <nav class="col-md-2 d-none d-md-block bg-light sidebar">
              <div class="sidebar-sticky">
                <ul class="nav flex-column">
                  <li class="nav-item">
                    <a class="nav-link active" href="#">
                      <span class="fas fa-home"></span>
                      Home <span class="sr-only">(current)</span>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      <span class="fas fa-book-open"></span>
                      Documents
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      <span class="far fa-hand-point-right"></span>
                      Examples
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      <span class="fab fa-github"></span>
                      GitHub
                    </a>
                  </li>
                </ul>
    
                <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                  <span>Network</span>
                  <a class="d-flex align-items-center text-muted" href="#">
                    <span data-feather="plus-circle"></span>
                  </a>
                </h6>
                <ul class="nav flex-column mb-2">
                  <li class="nav-item" >
                    <a class="nav-link" href="#" id="SWG">
                      <span data-feather="file-text"></span>
                      Small World
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#" id="PrefA">
                      <span data-feather="file-text"></span>
                      PrefAttach
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#" id="random">
                      <span data-feather="file-text"></span>
                      Random
                    </a>
                  </li>

                  
                </ul>

                <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                    <span>Simulation</span>
                    <a class="d-flex align-items-center text-muted" href="#">
                      <span data-feather="plus-circle"></span>
                    </a>
                  </h6>
                  <ul class="nav flex-column mb-2">
                    <li class="nav-item" >
                      <a class="nav-link" href="#" id="UserLevel">
                        <span data-feather="file-text"></span>
                        User Level
                      </a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="#" id="CityLevel">
                        <span data-feather="file-text"></span>
                        City Level
                      </a>
                    </li>
                    </div>
                  </div>
              </div>
            </nav>
    
            <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
              
              
              <div id="container"></div> 
              <div class="ct-chart ct-perfect-fourth" ></div>
  

            
            <div class="modal fade" id="Dialog" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Threshold Model</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="row">
                      <div class="col"><label for="nodes">Nodes</label></div>
                      <div class="col"><input type="number" id="node" name="nodes" min="1"></div>
                      <div class="w-100"></div>
                      <div class="col"><label for="edges">Edges</label></div>
                      <div class="col"><input type="number" id="edges" name="edges" min="0"></div>
                      <div class="w-100"></div>
                      <div class="col"><label for="infected">Infected</label></div>
                      <div class="col"><input type="number" id="infected" name="infected" min="0" max="1" step="1e-5" vaule="0.1"></div>
                      <div class="w-100"></div>
                      <div class="col"><label for="threshold">Threshold</label></div>
                      <div class="col"><input type="number" id="threshold" name="threshold" min="0" max="1" step="1e-5"></div>
                      <div class="w-100"></div>
                      <div class="col"><label for="iteration">Iteration</label></div>
                      <div class="col"><input type="number" id="iteration" name="iteration" min="1"></div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="run">Run</button>
                  </div>
                </div>
              </div>
            </div>
           
            
            
            <div class="modal fade" id="SWGDialog" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Small World Graph Generator</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="row">
                      <div class="col"><label for="nodes">Nodes</label></div>
                      <div class="col"><input type="number" id="nodes" name="nodes" min="1"></div>
                      <div class="w-100"></div>
                      <div class="col"><label for="edges">Out Degree</label></div>
                      <div class="col"><input type="number" id="outdegree" name="edges" min="0"></div>
                      <div class="w-100"></div>
                      <div class="col"><label for="rewirepb">Rewire Probability</label></div>
                      <div class="col"><input type="number" id="rewirepb" name="infected" min="0" max="1" step="1e-5" vaule="0.1"></div>
                      <div class="w-100"></div>
        
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="SWGrun">Run</button>
                  </div>
                </div>
              </div>
            </div>
            

             
             <div class="modal fade" id="PreADialog" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">PreAttach Graph Generator</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="row">
                      <div class="col"><label for="nodes">Nodes</label></div>
                      <div class="col"><input type="number" id="Pre_nodes" name="nodes" min="1"></div>
                      <div class="w-100"></div>
                      <div class="col"><label for="edges">Out Degree</label></div>
                      <div class="col"><input type="number" id="Pre_outdegree" name="edges" min="0"></div>
                      <div class="w-100"></div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="Prefrun">Run</button>
                  </div>
                </div>
              </div>
            </div>
            

             
             <div class="modal fade" id="RandomDialog" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Random Graph Generator</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="row">
                      <div class="col"><label for="nodes">Nodes</label></div>
                      <div class="col"><input type="number" id="random_nodes" name="nodes" min="1"></div>
                      <div class="w-100"></div>
                      <div class="col"><label for="edges">Edges</label></div>
                      <div class="col"><input type="number" id="random_edges" name="edges" min="0"></div>
                      <div class="w-100"></div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="randomrun">Run</button>
                  </div>
                </div>
              </div>
            </div>
             

            
            <div class="modal fade" id="UserDialog" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">User Level Simulator</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="row">
                      <div class="col"><label for="seednodes">Seed Nodes</label></div>
                      <div class="col"><input type="number" id="seednodes" name="nodes" min="1"></div>
                      <div class="w-100"></div>
                      <div class="col"><label for="algorithm">Algorithm</label></div>
                      <div class="col"><select id="algorithm">
                        <option value="degree">Degree Centrality</option>
                        <option value="between">Betweenness Centrality</option>
                        <option value="close">Closeness Centrality</option>
                        <option value="elgenvetor">Elgenvetor Centrality</option>
                        <option value="random">Random Centrality</option>
                      </select></div>
                    </div>
                     
                    
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="seedsrun">Run</button>
                  </div>
                </div>
              </div>
            </div>
             
            </main>
          </div>
        </div>
    -->
        
        <!-- Placed at the end of the document so the pages load faster 
        <script src="/static/libs/jquery-3.3.1.min.js" ></script>
        <script src="/static/libs/popper.min.js"></script>
        <script src="/static/libs/bootstrap/js/bootstrap.min.js"></script>
        
        <script src="/static/libs/f2.js"></script>
        <script src="/static/libs/chartist/chartist.min.js"></script>
        <script src="/static/libs/d3.min.js"></script>
        
    
    
        <script>
              let forceGraph = (options) => {
                  let anchor = options['anchor']
                  let nodeRadius = options['nodeRadius']

                  let svg = d3.select(anchor).append('svg')
                  let shapes = svg.append('g')
                  let zoom = (zoomView, minExtent, maxExtent) => d3.zoom().scaleExtent([minExtent, maxExtent]).on('zoom', () => zoomView.attr('transform', d3.event.transform))
                  svg.call(zoom(shapes, .25, 8))

                  let w = svg.node().parentNode.clientWidth
                  let h = svg.node().parentNode.clientHeight

                  let simulation = d3.forceSimulation()
                    .force('charge', d3.forceManyBody())
                    .force('center', d3.forceCenter(w / 2, h / 2))
                    .force('collide', d3.forceCollide(25))
                  let draggable = d3.drag()
                    .on('start', datum => {
                      if (!d3.event.active) simulation.alphaTarget(.3).restart()
                      datum.fx = datum.x
                      datum.fy = datum.y
                    })
                    .on('drag', datum => {
                      datum.fx = d3.event.x
                      datum.fy = d3.event.y
                    })
                    .on('end', datum => {
                      if (!d3.event.active) simulation.alphaTarget(0)
                      datum.fx = null
                      datum.fy = null
                    })

                  let bindLinks = (dataset, anchor) => {
                    let slots = anchor.selectAll('line').data(dataset)
                    slots.exit().remove()
                    let gLinks = slots.enter().append('line')
                      .merge(slots).attr('id', datum => 'l' + datum['id'])
                      .classed('link-normal', true)
                    return gLinks
                  }
                  
                  let bindNodes = (dataset, anchor) => {
                    let slots = anchor.selectAll('g').data(dataset)
                    slots.exit().remove()
                    let gNodes = slots.enter().append('g')
                    gNodes.append('circle').attr('r', nodeRadius).classed('node-normal', true)
                    gNodes = gNodes.merge(slots).attr('id', datum => datum.id).call(draggable)
                    return gNodes
                  }

                  let linkAnchor = shapes.append('g').classed('links', true)

                  let nodeAnchor = shapes.append('g').classed('nodes', true)

                  let importData = (nodeArr, linkArr) => {

                    let nodes = bindNodes(nodeArr, nodeAnchor)
                    let links = bindLinks(linkArr, linkAnchor)
                    
                    let ticked = () => {
                      links.attr('x1', (datum) => datum['source'].x)
                      .attr('y1', (datum) => datum['source'].y)
                      .attr('x2', (datum) => datum['target'].x)
                      .attr('y2', (datum) => datum['target'].y)

                      nodes.attr('transform', datum => `translate(${datum.x}, ${datum.y})`)
                    }

                    simulation.nodes(nodeArr).on('tick', ticked)
                    simulation.force('link', d3.forceLink(linkArr).id(datum => datum['id']))
                    simulation.alphaTarget(.3).restart()
                  }
                  return importData
                }

              let fg = forceGraph({
                  anchor: '#container',
                  nodeRadius: 10
                })

              
              $( "#t" ).click(function() {
                $('#Dialog').modal('show');
              });
              
              $( "#SWG" ).click(function() {
                $('#SWGDialog').modal('show');
              });
              
              $( "#SWGrun" ).click(function() {
                console.log($('#nodes').val())
                var nodes=parseInt($('#nodes').val());
                console.log(nodes)
                if(nodes<=0) {
                  nodes=Math.random()*10; }
                var outdegree=parseInt($('#outdegree').val());
                if(outdegree<0) {
                  outdegree=Math.random()*10; }
                var rewirepb=parseFloat($('#rewirepb').val());
                if(rewirepb<0) {
                  rewirepb=Math.random(); }
                
                $.ajax({
                url: "/smallworld",
                type:'POST',
                data: {"nodes":nodes,"outdegree":outdegree,"rewirepb":rewirepb}
                }).done(function(res) {
                //chartist
                var obj = JSON.parse(res)
                fg(obj['nodes'], obj['links']);
                    
                console.log(res)
                })
              });
             

              $( "#PrefA" ).click(function() {
                $('#PreADialog').modal('show');
              }); 

              $( "#Prefrun" ).click(function() {
                var nodes=parseInt($('#seednodes').val());
                console.log(nodes)
                if(nodes<=0) {
                  nodes=Math.random()*10; }
                var outdegree=parseInt($('#Pre_outdegree').val());
                if(outdegree<0) {
                  outdegree=Math.random()*10; }
              
                $.ajax({
                url: "/PrefAttach",
                type:'POST',
                data: {"nodes":nodes,"outdegree":outdegree}
                }).done(function(res) {
                //chartist
                var obj = JSON.parse(res)
                fg(obj['nodes'], obj['links']);
                    
                console.log(res)
                })
              });

              $( "#random" ).click(function() {
                $('#RandomDialog').modal('show');
              }); 

              $( "#randomrun" ).click(function() {
                var nodes=parseInt($('#random_nodes').val());
                console.log(nodes)
                if(nodes<=0) {
                  nodes=Math.random()*10; }
                var edges=parseInt($('#random_edges').val());
                if(edges<0) {
                  edges=Math.random()*10; }
              
                $.ajax({
                url: "/Random",
                type:'POST',
                data: {"nodes":nodes,"edges":edges}
                }).done(function(res) {
                //chartist
                var obj = JSON.parse(res)
                fg(obj['nodes'], obj['links']);
                    
                console.log(res)
                })
              });

              $( "#UserLevel" ).click(function() {
                $('#UserDialog').modal('show');
              }); 

              $( "#seedsrun" ).click(function() {
                var seednodes=parseInt($('#seednodes').val());
                console.log(nodes)
                if(nodes<=0) {
                  seednodes=Math.random()*10; }
                var algorithm=parse($('#algorithm').val());
                
                $.ajax({
                url: "/seednodes",
                type:'POST',
                data: {"seednodes":seednodes,"algorithm":algorithm}
                }).done(function(res) {
                //chartist
                var obj = JSON.parse(res)
                fg(obj['nodes'], obj['links']);
                    
                console.log(res)
                })
              });
              /*$( "#run" ).click(function() {
                var nodes=parseInt($('#nodes').val());
                if(nodes<=0) {
                  nodes=Math.random()*10;
                }
                var edges=parseInt($('#edges').val());
                if(nodes<0) {
                  edges=Math.random()*10;
                }
                var infected=parseFloat($('#infected').val());
                if(infected<0 || infected>1){
                  infected=Math.random();
                }
                var threshold=parseFloat($('#threshold').val());
                if(threshold<0 || threshold>1){
                  threshold=Math.random();
                }
                var iteration=parseInt($('#iteration').val());
                if(iteration<0){
                  iteration=Math.abs(iteration);
                }

                $.ajax({
                url: "/smallworld",
                type:'POST',
                data: {"nodes":nodes,"outdegree":outdegree,"infected":infected,"threshold":threshold,"iteration":iteration}
                }).done(function(res) {
                //chartist
                var obj = JSON.parse(res)
  
                new Chartist.Line('.ct-chart', obj);
                    
                console.log(res)
                })
              

                $.ajax({
                url: "/simulator1",
                type:'POST',
                data: {"nodes":nodes,"edges":edges,"rewirepb":rewirepb}
                }).done(function(res) {
                //chartist
                var obj = JSON.parse(res)
                
                
                new Chartist.Line('.ct-chart', obj);
                    
                console.log(res)
                })
              });*/

              

	
          </script>
-->

</body>
</html>